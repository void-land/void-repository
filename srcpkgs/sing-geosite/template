# Template file for 'sing-geosite'
pkgname=sing-geosite
version=20240713050854
revision=1
build_style=go
build_helper=qemu
go_import_path="github.com/sagernet/sing-geosite"
short_desc="Geosite database and rule sets for sing-box"
maintainer="hesam-init <hesam.init@gmail.com>"
license="GPL-3.0-or-later, LGPL-3.0-or-later"
homepage="https://github.com/SagerNet/sing-geosite"
changelog="https://github.com/SagerNet/sing-geosite/releases"
distfiles="https://github.com/SagerNet/sing-geosite/archive/refs/tags/${version}.tar.gz"
checksum="2913b0d12304caf96a7a204b53028e95ff37215518876594a83ff829930aa6e3"

post_build() {
   for f in ${GOPATH}/bin/* ${GOPATH}/bin/**/*; do
      if [ -f "$f" ] && [ -x "$f" ]; then
         NO_SKIP=true vtargetrun "$f"
      fi
   done
}

do_install() {
   vmkdir usr/share/sing-box
   vmkdir usr/share/sing-box/rule-set
}

post_install() {
   ls -la
}

sing-geoip-db_package() {
   short_desc="sing-geoip (database)"

   pkg_install() {
      vcopy *.db usr/share/sing-box
   }
}

sing-geoip-rule-set_package() {
   short_desc="sing-geoip (rule sets)"

   pkg_install() {
      vcopy rule-set/* usr/share/sing-geosite/rule-set
   }
}
